(GET-PROCESS -ID $PID).PRIORITYCLASS=[SYSTEM.DIAGNOSTICS.PROCESSPRIORITYCLASS]::IDLE;$null=REGISTER-WMIEVENT -QUERY "SELECT * FROM RegistryKeyChangeEvent WHERE Hive='HKEY_USERS' AND KeyPath='$([System.Security.Principal.WindowsIdentity]::GetCurrent().User.Value)\\Control Panel\\NotifyIconSettings'" -ACTION {TRY{$B=GET-CHILDITEM -PATH "HKCU:\CONTROL PANEL\NOTIFYICONSETTINGS" -ERRORACTION STOP}CATCH{$C=NEW-OBJECT -COMOBJECT WSCRIPT.SHELL;$C.POPUP("[""Always show all icons and notifications on the taskbar"" fix by Liub0myr]: AN ERROR OCCURRED WHILE SCANNING THE REGISTRY FOR NEW PROGRAMS.");RETURN 1};FOREACH($D IN $B){$A=GET-ITEMPROPERTY -PATH $D.PSPATH -NAME "ISPROMOTED" -ERRORACTION SILENTLYCONTINUE;IF($A -OR $A.ISPROMOTED -NE 1){SET-ITEMPROPERTY -PATH $D.PSPATH -NAME "ISPROMOTED" -VALUE 1}}}